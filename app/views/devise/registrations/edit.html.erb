<div class="row">
  <div class="medium-12 columns authform">
    <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, role: 'form'}) do |f| %>
    <%= simple_fields_for resource.person do |ff| %>
    <h2>Edit Your Account</h2>
    <div class="row">
      <div class="medium-6 columns">
        <div class="panel">
          <div class="row">
            <div class="medium-2 columns">
              <%= ff.input :title, collection: Person.titles %>
            </div>
            <div class="medium-8 columns">
              <%= ff.input :name, as: :string %>
            </div>
            <div class="medium-2 columns">
              <%= ff.input :suffix, collection: Person.suffixes %>
            </div>
          </div>
          <div class="row">
            <div class="medium-10 columns">
              <div class="row">
                <%= ff.input :dob, label: 'Date of Birth', as: :date, start_year: Date.today.year - 120,
                             end_year: Date.today.year - 12, default: Date.today - 18.years, input_html: { class: 'medium-4 columns' } %>
              </div>
            </div>
            <div class="medium-2 columns">
              <%= ff.input :sex, collection: Person.sexes %>
            </div>
          </div>
          <div class="row">
            <div class="medium-6 columns">
              <%= ff.input :gender, as: :string %>
            </div>
            <div class="medium-6 columns">
              <%= ff.input :pronoun, as: :string %>
            </div>
          </div>
          <%= f.input :uuid, as: :string, label: 'Student ID' %>
        </div>
      </div>
      <div class="medium-6 columns">
        <%= f.input :email, autofocus: true %>
        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
        <% end %>
        <fieldset class="panel callout">
          <p>You must enter your current password to make changes.</p>
          <%= f.input :current_password %>
        </fieldset>
        </div>
      </div>
      <div class="row">
        <div class="medium-12 columns">
          <fieldset>
            <p>Leave these fields blank if you don't want to change your password.</p>
            <div class="row">
              <div class="medium-6 columns">
                <%= f.input :password, label: 'New password' %>
              </div>
              <div class="medium-6 columns">
                <%= f.input :password_confirmation, label: 'Confirm password' %>
              </div>
            </div>
          </fieldset>
        <%= f.submit 'Update', class: 'button right' %>
      </div>
    </div>
    <div class="row">
      <div class="medium-6 columns">
        <div class="panel">
          <h4>Close Account &amp; Delete Data</h4>
          <p>Unhappy? We'll be sad to see you go. All your personal data will be deleted <strong>immediately and irreversibly</strong>.</p>
          <%= button_to 'Close my account', registration_path(resource_name), data: { confirm: 'All your data will be deleted IMMEDIATELY, and this process is IRREVERSIBLE. Are you sure you want to close your account?'}, method: :delete, class: 'button tiny alert' %>
        </div>
      </div>
    </div>
    <% end %>
    <% end %>
  </div>
</div>